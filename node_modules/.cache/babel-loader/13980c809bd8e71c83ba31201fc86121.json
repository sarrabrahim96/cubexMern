{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/cubex2/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/User/Desktop/cubex2/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/User/Desktop/cubex2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useState,useEffect}from'react';import OffersApi from\"./api/offerApi\";import UserAPI from\"./api/UserApi\";import UsersAPI from'./api/UsersAPI';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";export var GlobalState=/*#__PURE__*/createContext();export var DataProvider=function DataProvider(_ref){var children=_ref.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];useEffect(function(){var firstLogin=localStorage.getItem('firstLogin');if(firstLogin){var refreshToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/user/refresh_token');case 2:res=_context.sent;setToken(res.data.accessToken);setTimeout(function(){refreshToken();},10*60*1000);case 5:case\"end\":return _context.stop();}}},_callee);}));return function refreshToken(){return _ref2.apply(this,arguments);};}();refreshToken();}},[]);var state={token:[token,setToken],offersApi:OffersApi(),UserApi:UserAPI(token),UsersAPI:UsersAPI()};return/*#__PURE__*/_jsx(GlobalState.Provider,{value:state,children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","OffersApi","UserAPI","UsersAPI","axios","GlobalState","DataProvider","children","token","setToken","firstLogin","localStorage","getItem","refreshToken","get","res","data","accessToken","setTimeout","state","offersApi","UserApi"],"sources":["C:/Users/User/Desktop/cubex2/client/src/GlobalState.js"],"sourcesContent":["import React , {createContext , useState , useEffect} from 'react'\r\nimport OffersApi from \"./api/offerApi\"\r\nimport UserAPI from \"./api/UserApi\"\r\nimport UsersAPI from './api/UsersAPI'\r\nimport axios from 'axios'\r\n\r\n\r\nexport const GlobalState = createContext()\r\n\r\nexport const DataProvider = ({children}) => {\r\n  const [token , setToken] = useState(false)\r\n  \r\n  useEffect(()=>{\r\n    const firstLogin = localStorage.getItem('firstLogin')\r\n    if(firstLogin ){    \r\n      const refreshToken = async () => {\r\n      const res = await axios.get('/user/refresh_token')\r\n      setToken(res.data.accessToken)\r\n\r\n      setTimeout(() =>{\r\n        refreshToken()\r\n      }, 10 * 60 * 1000)\r\n    }\r\n     refreshToken()\r\n\r\n    }\r\n\r\n  },[])\r\n  \r\n   const state ={\r\n    token : [token , setToken],\r\n    offersApi : OffersApi(),\r\n    UserApi : UserAPI(token),\r\n    UsersAPI : UsersAPI()\r\n\r\n\r\n  }\r\n\r\n  return(\r\n    <GlobalState.Provider value={state}>\r\n        {children}\r\n    </GlobalState.Provider>\r\n  )\r\n}\r\n\r\n"],"mappings":"2XAAA,MAAOA,MAAK,EAAIC,aAAa,CAAGC,QAAQ,CAAGC,SAAS,KAAO,OAAO,CAClE,MAAOC,UAAS,KAAM,gBAAgB,CACtC,MAAOC,QAAO,KAAM,eAAe,CACnC,MAAOC,SAAQ,KAAM,gBAAgB,CACrC,MAAOC,MAAK,KAAM,OAAO,4CAGzB,MAAO,IAAMC,YAAW,cAAGP,aAAa,EAAE,CAE1C,MAAO,IAAMQ,aAAY,CAAG,QAAfA,aAAY,MAAmB,IAAdC,SAAQ,MAARA,QAAQ,CACpC,cAA2BR,QAAQ,CAAC,KAAK,CAAC,wCAAnCS,KAAK,eAAGC,QAAQ,eAEvBT,SAAS,CAAC,UAAI,CACZ,GAAMU,WAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CACrD,GAAGF,UAAU,CAAE,CACb,GAAMG,aAAY,6FAAG,mKACHT,MAAK,CAACU,GAAG,CAAC,qBAAqB,CAAC,QAA5CC,GAAG,eACTN,QAAQ,CAACM,GAAG,CAACC,IAAI,CAACC,WAAW,CAAC,CAE9BC,UAAU,CAAC,UAAK,CACdL,YAAY,EAAE,CAChB,CAAC,CAAE,EAAE,CAAG,EAAE,CAAG,IAAI,CAAC,uDACnB,kBAPOA,aAAY,2CAOnB,CACAA,YAAY,EAAE,CAEf,CAEF,CAAC,CAAC,EAAE,CAAC,CAEJ,GAAMM,MAAK,CAAE,CACZX,KAAK,CAAG,CAACA,KAAK,CAAGC,QAAQ,CAAC,CAC1BW,SAAS,CAAGnB,SAAS,EAAE,CACvBoB,OAAO,CAAGnB,OAAO,CAACM,KAAK,CAAC,CACxBL,QAAQ,CAAGA,QAAQ,EAGrB,CAAC,CAED,mBACE,KAAC,WAAW,CAAC,QAAQ,EAAC,KAAK,CAAEgB,KAAM,UAC9BZ,QAAQ,EACU,CAE3B,CAAC"},"metadata":{},"sourceType":"module"}